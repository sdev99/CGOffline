<app-portrait-orientation *ngIf="isShowOritationPortrait;else formView"
                          (close)="isShowOritationPortrait=false"></app-portrait-orientation>

<ng-template #formView>

    <ion-header mode="ios" *ngIf="formBuilderDetail">
        <app-modal-header *ngIf="!sharedDataService.dedicatedMode;"
                          modalTitle="{{formBuilderDetail?.title}}"
                          (closeModal)="onClose()"></app-modal-header>

        <app-modal-header-dm *ngIf="sharedDataService.dedicatedMode"
                             [modalTitle]="sharedDataService.dedicatedModeLocationUse.title" (closeModal)="onClose()"
                             [modalSubTitle]="formBuilderDetail?.title"></app-modal-header-dm>
    </ion-header>


    <ion-content mode="md" [ngClass]="{'dedicated-mode':sharedDataService.dedicatedMode}">
        <app-warning-component *ngIf="errorMessage && errorMessage.length>0"
                               [message]="errorMessage"></app-warning-component>

        <app-exposure label="Your Current Exposure" [points]="currentExposure" containerClassName="top"></app-exposure>

        <Form [formGroup]="formGroup" (ngSubmit)="onSubmit()">

            <ion-list lines="none" mode="ios" *ngFor="let section of formBuilderDetail?.sections">
                <ng-container *ngIf="!section.sectionIsHidden">
                    <ng-container *ngIf="section.isHAVSection; else customQuestions">
                        <ng-container *ngFor="let question of section.questions">

                            <ng-container *ngIf="!question.questionIsHidden">

                                <app-date-field
                                        *ngIf="question.selectedAnswerTypeId === EnumService.CustomAnswerType.DateField"
                                        [form]="formGroup"
                                        [inputName]="UtilService.FCName( question.questionId)"
                                        [label]="UtilService.findObj(question.questionTranslations, 'questionTranslationLanguageId', sharedDataService.currentLanguageId).questionTranslationTitle"
                                        [isError]="isError( question)"
                                        placeholder="Choose"
                                ></app-date-field>

                                <app-dropdown-field
                                        *ngIf="question.selectedAnswerTypeId === EnumService.CustomAnswerType.ClassicDropdown"
                                        [form]="formGroup"
                                        [inputName]="UtilService.FCName(question.questionId)"
                                        [label]="UtilService.findObj(question.questionTranslations, 'questionTranslationLanguageId', sharedDataService.currentLanguageId).questionTranslationTitle"
                                        [isError]="isError( question)"
                                        [list]="question.answerChoiceAttributes"
                                        [listLabelKey]="question.listLabelKey"
                                        [listValueKey]="question.listValueKey"
                                        (valueChange)="dropDownChange(question)"
                                        placeholder="Choose"
                                ></app-dropdown-field>


                                <app-number-integer-field
                                        *ngIf="question.selectedAnswerTypeId === EnumService.CustomAnswerType.TimeField"
                                        [form]="formGroup"
                                        [inputName]="UtilService.FCName( question.questionId)"
                                        [label]="UtilService.findObj(question.questionTranslations, 'questionTranslationLanguageId', sharedDataService.currentLanguageId).questionTranslationTitle"
                                        [isError]="isError(question)"
                                ></app-number-integer-field>
                            </ng-container>
                        </ng-container>


                        <app-exposure label="Calculated Exposure" [points]="calculateExposure()"
                                      containerClassName="bottom"></app-exposure>
                        <app-exposure label="Total Exposure Will Be"
                                      [points]="calculateExposure(currentExposure)"></app-exposure>

                    </ng-container>

                    <ng-template #customQuestions>
                        <app-custom-questions-container
                                [sectionId]="section.sectionId"
                                [questions]="section.questions"
                                [isSubmitted]="isSubmitted"
                                [formGroup]="formGroup"
                        ></app-custom-questions-container>
                    </ng-template>
                </ng-container>
            </ion-list>


            <!--        End of form -->
            <ng-container *ngIf="!sharedDataService.dedicatedMode">

                <div class="hr-line-full ion-margin-top"></div>

                <ion-item class="ion-margin-vertical text-bottom-msg">
                    <ion-label class="ion-text-wrap ion-text-center">
                        You've reached the end of the form.
                        Please check your answers and sign-off.
                    </ion-label>
                </ion-item>

                <ion-item class="ion-margin-vertical ion-padding-bottom">
                    <ion-button type="submit" expand="full" class="action-btn">Sign-Off</ion-button>
                </ion-item>

            </ng-container>

            <!--        End of form -->
            <ng-container *ngIf="sharedDataService.dedicatedMode">
                <ion-item class="text-bottom-msg" lines="none">
                    <ion-label class="ion-text-wrap ion-padding">
                        You've reached the end of the form.
                        Please check your answers and sign-off.
                    </ion-label>
                    <ion-button type="submit" slot="end" class="action-btn">Sign-Off</ion-button>
                </ion-item>
            </ng-container>
        </Form>

    </ion-content>
</ng-template>
