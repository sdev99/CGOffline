<app-portrait-orientation *ngIf="isShowOritationPortrait;else formView"
                          (close)="isShowOritationPortrait=false"></app-portrait-orientation>

<ng-template #formView>
    <ion-header mode="ios">
        <ng-container *ngIf="sharedDataService.dedicatedMode; else personalMode">
            <app-modal-header-dm [modalTitle]="sharedDataService.getCurrentCheckedInEntityName()"
                                 (closeModal)="onClose()"
                                 [modalSubTitle]="activityDetail?activityDetail.title:''"></app-modal-header-dm>
        </ng-container>

        <ng-template #personalMode>
            <ion-toolbar mode="ios" class="model-header-toolbar">
                <ion-title size="large">{{formBuilderDetail?.title}}</ion-title>
                <ion-buttons slot="end">
                    <app-model-close-button (closeModal)="onClose()"></app-model-close-button>
                </ion-buttons>
            </ion-toolbar>

            <app-next-prev-toolbar content [isError]="(errorMessage && errorMessage.length>0)"
                                   [currentCount]="currentQuestionIndex"
                                   [totalCount]="questionElementIds?.length" (next)="next()"
                                   (previous)="previous()"></app-next-prev-toolbar>
        </ng-template>

        <app-warning-component *ngIf="errorMessage" [message]="errorMessage"></app-warning-component>

    </ion-header>


    <ion-content
        #content
        [scrollEvents]="true"
        (ionScrollEnd)="onScrollEnd($event)"
        (ionScroll)="onScroll($event)"
        mode="ios"
        [ngClass]="{'dedicated-mode':sharedDataService.dedicatedMode}">

        <div class="form-container">
            <Form [formGroup]="formGroup" (ngSubmit)="onSubmit()">

                <ion-list lines="none" mode="ios">

                    <ng-container *ngFor="let section of formBuilderDetail?.sections; let sectionIndex = index;">
                        <ng-container *ngIf="utilService.shouldShowSection(section)">
                            <app-section-title
                                    [title]="UtilService.findObj(section.sectionTranslations, 'sectionTranslationLanguageId', sharedDataService.currentLanguageId).sectionTranslationTitle">
                            </app-section-title>

                            <app-custom-questions-container
                                    [sectionIndex]="sectionIndex"
                                    [sectionId]="section.sectionId"
                                    [questionElementIds]="questionElementIds"
                                    [questions]="section.questions"
                                    [isSubmitted]="isSubmitted"
                                    [formGroup]="formGroup"
                            ></app-custom-questions-container>
                        </ng-container>
                    </ng-container>


                    <!--        End of form -->
                    <ng-container
                            *ngIf="!sharedDataService.dedicatedMode">

                        <div class="hr-line-full ion-margin-top"></div>

                        <ion-item class="ion-margin-vertical text-bottom-msg">
                            <ion-label class="ion-text-wrap ion-text-center">
                                You've reached the end of the form.
                                Please check your answers and sign-off.
                            </ion-label>
                        </ion-item>

                        <ion-item class="ion-margin-vertical ion-padding-bottom">
                            <ion-button type="submit" expand="full" class="action-btn">Sign-Off</ion-button>
                        </ion-item>

                    </ng-container>


                </ion-list>
            </Form>

            <div class="fill-vertical-space"></div>
            <!--        End of form -->
            <ng-container *ngIf="sharedDataService.dedicatedMode">
                <ion-item class="text-bottom-msg" lines="none">
                    <ion-label class="ion-text-wrap ion-padding">
                        You've reached the end of the form.
                        Please check your answers and sign-off.
                    </ion-label>
                    <ion-button slot="end" class="action-btn" (click)="onSubmit()">Sign-Off</ion-button>
                </ion-item>
            </ng-container>
        </div>
    </ion-content>
</ng-template>



